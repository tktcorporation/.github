<p align="center">
<br>
<h1 align="center">berm</h1>
<p align="center">
A bi-directional dev environment template that evolves with you.
</p>
<br>
<p align="center">
<a href="https://www.npmjs.com/package/@tktco/berm"><img src="https://img.shields.io/npm/v/@tktco/berm?color=a1b858&label=" alt="npm version"></a>
<a href="https://www.npmjs.com/package/@tktco/berm"><img src="https://img.shields.io/npm/dm/@tktco/berm?color=50a36f&label=" alt="npm downloads"></a>
<a href="https://github.com/tktcorporation/.github/blob/main/LICENSE"><img src="https://img.shields.io/github/license/tktcorporation/.github?color=blue&label=" alt="license"></a>
</p>
<br>
</p>

> _berm_ — a shaped, maintained buffer zone between structures. Like a berm bridges terrain, this tool bridges the gap between your template and your projects.

## Why

Templates go stale the moment you scaffold them. Each project improves upon the original — better configs, new workflows, refined settings — but those improvements never flow back.

**berm** solves this with bi-directional sync:

- **`init`** — Pull the latest template into your project
- **`push`** — Push your improvements back to the template
- **`diff`** — See what's changed

Your template stays alive, fed by every project that uses it.

<!-- USAGE:START -->

## Usage

```bash
# Apply template to current directory
npx @tktco/berm

# Apply to a specific directory
npx @tktco/berm ./my-project

# Push your improvements back
npx @tktco/berm push -m "Add new workflow"

# Check what's different
npx @tktco/berm diff
```

<!-- USAGE:END -->

<!-- FEATURES:START -->

## Modules

Pick what you need:

- **Root** - MCP, mise, and other root-level config files
- **DevContainer** - VS Code DevContainer with Docker-in-Docker
- **GitHub** - GitHub Actions and labeler workflows
- **Claude** - Claude Code project settings

<!-- FEATURES:END -->

<!-- COMMANDS:START -->

## Commands

### `init`

Apply dev environment template to your project

```
Apply dev environment template to your project (berm vdev)

USAGE `berm [OPTIONS] [DIR]`

ARGUMENTS

  `DIR="."`    Target directory

OPTIONS

                   `--force`    Overwrite existing files
                 `-y, --yes`    Select all modules (non-interactive mode)
             `-m, --modules`    Comma-separated module IDs to apply (non-interactive)
  `-s, --overwrite-strategy`    Overwrite strategy: overwrite, skip, or prompt (non-interactive)
```

### `push`

Push local changes to the template repository as a PR

```
Push local changes to the template repository as a PR (push)

USAGE `push [OPTIONS] [DIR]`

ARGUMENTS

  `DIR="."`    Project directory

OPTIONS

              `-n, --dryRun`    Preview only, don't create PR
             `-m, --message`    PR title
               `-f, --force`    Skip confirmation prompts
  `--no-i, --no-interactive`    Select files while reviewing diffs (enabled by default)
             `-p, --prepare`    Generate a manifest file for AI-agent friendly workflow (no PR created)
             `-e, --execute`    Execute push using the manifest file generated by --prepare
```

### `diff`

Show differences between local and template

```
Show differences between local and template (diff)

USAGE `diff [OPTIONS] [DIR]`

ARGUMENTS

  `DIR="."`    Project directory

OPTIONS

  `-v, --verbose`    Show detailed diff
```

### `ai-docs`

Show documentation for AI coding agents

```
Show documentation for AI coding agents (ai-docs)

USAGE `ai-docs `
```

<!-- COMMANDS:END -->

<!-- AI_AGENTS:START -->

## For AI Agents

AI coding agents can use the non-interactive workflow:

```bash
# 1. Generate manifest file
npx @tktco/berm push --prepare

# 2. Edit .devenv-push-manifest.yaml to select files and set PR details

# 3. Create PR from manifest
npx @tktco/berm push --execute
```

For detailed documentation, run:

```bash
npx @tktco/berm ai-docs
```

<!-- AI_AGENTS:END -->

<!-- FILES:START -->

## What You Get

Files generated based on selected modules:

### Root

MCP, mise, and other root-level config files

- `.mcp.json`
- `.mise.toml`

### `.devcontainer/`

VS Code DevContainer with Docker-in-Docker

- `.devcontainer/devcontainer.json`
- `.devcontainer/.gitignore`
- `.devcontainer/setup-*.sh`
- `.devcontainer/test-*.sh`
- `.devcontainer/.env.devcontainer.example`
- `.devcontainer/run-chrome-devtools-mcp.sh`

### `.github/`

GitHub Actions and labeler workflows

- `.github/workflows/issue-link.yml`
- `.github/workflows/label.yml`
- `.github/labeler.yml`

### `.claude/`

Claude Code project settings

- `.claude/settings.json`
- `.claude/hooks/*.sh`
- `.claude/rules/*.md`

### Config

- `.devenv.json` - Tracks which modules are applied

<!-- FILES:END -->

## Contributing

See [CONTRIBUTING.md](./CONTRIBUTING.md).

## License

[MIT](./LICENSE) License &copy; [tktcorporation](https://github.com/tktcorporation)
